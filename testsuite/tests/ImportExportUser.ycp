/**
 * File:
 *  ImportExportUser.ycp
 *
 * Module:
 *  Users configurator
 *
 * Summary:
 *  converting user maps: autoyast -> users module -> autoyast
 *
 * Authors:
 *  Jiri Suchomel <jsuchome@suse.cz>
 *
 */

{

    include "testsuite.ycp";
    map I_READ = $[
	"target" : $[
	    "size" : -1,
	    "tmpdir" : "/tmp/",
	    "yast2" : nil,
	],
	"sysconfig" : $[
	    "console" : $[
		"CONSOLE_FONT" : "",
		"CONSOLE_SCREENMAP" : "",
		"CONSOLE_UNICODEMAP" : "",
		"CONSOLE_MAGIC" : "",
		"CONSOLE_ENCODING" : "",
	    ],
	    "language" : $[
		"RC_LANG" : "",
		"DEFAULT_LANGUAGE" : "",
	    ],
	],
	"etc" : $[
	    "install_inf" : $[
		"Cmdline" : "",
		"InstMode" : nil,
	    ],
	],
	"probe" : $[
	    "architecture" : "i386",
	    "has_apm" : true,
	    "has_pcmcia" : false,
	    "has_smp" : false,
	    "system" : [],
	    "memory" : [],
	    "cpu" : [],
	    "cdrom" : $[
		"manual" : [],
	    ],
	    "floppy" : $[
		"manual" : [],
	    ],
	],
    ];
    map I_WRITE = $[];
    map I_EXEC = $[];
    TESTSUITE_INIT ([I_READ, I_WRITE, I_EXEC], 0);

    import "Users";

    map EX = $[
        "target": $[ "bash_output": $[] ]
    ];

    map importing = $[
	"encrypted": true,
	"forename":"aa",
	"surname":"A",
	"uid":500,
        "gid":500,
	"home":"/home/aaa",
	"user_password":"5OkhN2nLxMfEY",
	"password_settings":$[
        "inact":-1,
        "max":99999,
        "min":0,
        "warn":7
        ],
        "grouplist":"audio",
	"shell":"/bin/bash",
	"username":"aaa"
    ];

    DUMP ( sformat ("importing:\n %1", importing) );

    DUMP ("==== processing ImportUser... ============================");

    map user = TEST(``(Users::ImportUser (importing)), [ [], [], EX ], 0);

    DUMP ("==== processing ExportUser... ============================");

    TEST(``(Users::ExportUser (user)), [], 0);

}
