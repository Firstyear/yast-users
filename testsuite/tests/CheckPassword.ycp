{
    // testedfiles: Users.pm
    import "Testsuite";
    import "Users";
    import "UsersCache";

    define void test_ui (string username, string pw) {

	Testsuite::Test (``(Users::CheckPasswordUI (username, pw, $[])), [], 0);
    }

    define void test_contents (string pw) {

	Testsuite::Dump (sformat ("-------- password: %1", pw));
	string err = (string)Testsuite::Test (``(Users::CheckPassword (pw)), [], 0);
	if (err != "")
	    Testsuite::Dump (sformat ("-------- error: %1", err));
    }

    test_ui ("hh", "qqqqq");
    test_ui ("hh", "12hh5");
    test_ui ("hh", "12345");
    test_ui ("hh", "1a");
    test_ui ("hh", "1aaaaaaaaaaaaaaaaa");
    test_contents ("`!@#$%^&*()-=_+|");
    test_contents ("[];',./{}:\"<>");
    test_contents ("\\");
}
